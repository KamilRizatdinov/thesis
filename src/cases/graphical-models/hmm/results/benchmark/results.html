<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>chart-csv</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.css" rel="stylesheet" type="text/css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.15/d3.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
</head>
<body onload="run()">

<div id="graph"></div>

<script>

function parseCSV (csv) {
  return csv.split('\n')
    .filter(function (row) {
      return !!row.trim()
    })
    .map(function (row) {
      return row.split(',')
    })
}

function haveHead (csv) {
  return !/^\d+$/.test(csv[0][0])
}

function chart (id, csv) {
  csv = parseCSV(csv)

  var columns = []
  var showLegend = haveHead(csv)

  if (showLegend) {
    csv.shift().forEach(function (head) {
      columns.push([head])
    })
  } else {
    for (var n = 0; n < csv[0].length; n++) {
      columns.push([n])
    }
  }

  csv.forEach(function (r) {
    r.forEach(function (c, i) {
      columns[i].push(parseInt(c, 10))
    })
  })

  var opts = {
    bindto: '#' + id,
    data: {
      columns: columns,
      type: 'line'
    },
    point: { show: false },
    axis: { x: { show: false } },
    legend: { show: showLegend }
  }

  c3.generate(opts)
}

function run () {
  chart('graph', csv)
}

var csv = `
asc_liftoff,asc_turbofan,js_ignition,js_sparkplug,js_turbofan
109,45,1966,120,129
108,44,1947,97,97
109,43,1953,99,99
108,42,1942,96,101
108,42,1947,96,103
108,42,1951,102,101
108,42,1943,97,98
112,42,1965,97,97
111,44,1951,97,97
113,42,1944,100,101
109,41,1933,104,99
108,42,1911,98,99
111,42,1914,97,96
109,46,1922,96,98
108,42,1915,98,97
107,42,1914,98,99
109,42,1913,100,99
109,42,1917,97,97
110,42,1917,98,97
108,42,1917,101,101
108,43,1920,98,97
108,44,1908,96,97
115,42,1921,97,96
108,42,1914,99,97
109,42,1916,97,99
108,43,1927,97,98
107,43,1910,97,96
109,41,1916,97,97
108,43,1914,99,97
109,41,1931,99,102
107,43,1926,99,101
111,42,1916,100,97
108,42,1927,98,97
108,41,1916,98,97
108,42,1915,97,97
109,42,1919,98,97
109,45,1924,97,97
109,43,1925,96,98
108,42,1919,98,100
107,45,1923,99,101
110,42,1919,99,98
110,42,1911,97,97
108,43,1993,98,97
108,41,2004,97,97
108,43,1979,96,101
109,41,1943,98,97
109,44,1918,98,96
111,42,1917,97,98
114,47,1918,97,97
113,42,1910,99,99
`

</script>
</body>
</html>
