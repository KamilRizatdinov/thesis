<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>chart-csv</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.css" rel="stylesheet" type="text/css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.15/d3.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
</head>
<body onload="run()">

<div id="graph"></div>

<script>

function parseCSV (csv) {
  return csv.split('\n')
    .filter(function (row) {
      return !!row.trim()
    })
    .map(function (row) {
      return row.split(',')
    })
}

function haveHead (csv) {
  return !/^\d+$/.test(csv[0][0])
}

function chart (id, csv) {
  csv = parseCSV(csv)

  var columns = []
  var showLegend = haveHead(csv)

  if (showLegend) {
    csv.shift().forEach(function (head) {
      columns.push([head])
    })
  } else {
    for (var n = 0; n < csv[0].length; n++) {
      columns.push([n])
    }
  }

  csv.forEach(function (r) {
    r.forEach(function (c, i) {
      columns[i].push(parseInt(c, 10))
    })
  })

  var opts = {
    bindto: '#' + id,
    data: {
      columns: columns,
      type: 'line'
    },
    point: { show: false },
    axis: { x: { show: false } },
    legend: { show: showLegend }
  }

  c3.generate(opts)
}

function run () {
  chart('graph', csv)
}

var csv = `
asc_liftoff,asc_turbofan,js_ignition,js_sparkplug,js_turbofan
110,42,1985,101,125
109,42,1936,97,108
113,42,1939,97,105
107,46,1940,101,104
108,42,1939,97,102
109,41,1934,102,99
108,42,1936,98,100
110,42,2015,97,110
107,42,2041,99,102
107,41,2001,97,100
109,43,1909,97,99
111,41,1906,97,101
111,42,1916,97,102
109,42,1909,101,107
108,47,1914,96,99
107,42,1909,99,101
110,42,1912,97,100
107,42,1910,97,97
108,42,1926,101,100
108,42,1906,104,111
107,42,1907,96,100
110,42,1910,97,98
109,46,1913,97,100
107,58,1892,101,104
109,43,1975,103,105
112,44,1986,117,103
107,43,1911,101,121
107,43,1920,98,114
108,43,1911,99,109
107,42,1903,101,104
108,43,1909,117,102
109,43,1903,111,100
106,58,1910,106,99
108,46,1914,99,99
111,49,1907,99,100
114,46,1911,111,105
108,45,1909,108,104
107,43,1913,99,101
107,43,1910,101,100
107,43,1908,103,99
108,43,1899,101,101
108,43,1911,99,118
107,43,1896,102,114
107,43,1913,101,101
110,42,1913,98,100
108,49,1907,99,98
108,50,1911,99,98
107,49,1907,101,98
107,55,1910,101,98
108,46,1928,107,98
`

</script>
</body>
</html>
