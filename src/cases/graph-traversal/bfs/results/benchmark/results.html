<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>chart-csv</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.css" rel="stylesheet" type="text/css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.15/d3.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
</head>
<body onload="run()">

<div id="graph"></div>

<script>

function parseCSV (csv) {
  return csv.split('\n')
    .filter(function (row) {
      return !!row.trim()
    })
    .map(function (row) {
      return row.split(',')
    })
}

function haveHead (csv) {
  return !/^\d+$/.test(csv[0][0])
}

function chart (id, csv) {
  csv = parseCSV(csv)

  var columns = []
  var showLegend = haveHead(csv)

  if (showLegend) {
    csv.shift().forEach(function (head) {
      columns.push([head])
    })
  } else {
    for (var n = 0; n < csv[0].length; n++) {
      columns.push([n])
    }
  }

  csv.forEach(function (r) {
    r.forEach(function (c, i) {
      columns[i].push(parseInt(c, 10))
    })
  })

  var opts = {
    bindto: '#' + id,
    data: {
      columns: columns,
      type: 'line'
    },
    point: { show: false },
    axis: { x: { show: false } },
    legend: { show: showLegend }
  }

  c3.generate(opts)
}

function run () {
  chart('graph', csv)
}

var csv = `
asc_liftoff,asc_turbofan,js_ignition,js_sparkplug,js_turbofan
230,188,513,192,200
259,200,474,173,143
215,161,503,131,175
198,151,469,114,118
240,181,472,142,110
225,168,493,117,128
236,235,468,164,106
213,180,491,110,148
201,175,473,116,104
197,246,490,117,106
218,190,466,146,107
239,303,493,143,164
213,232,476,122,122
207,163,472,124,105
210,153,480,113,127
202,149,493,122,105
208,157,472,142,140
203,146,502,109,105
210,153,470,140,107
197,145,470,108,130
220,161,493,114,104
242,185,471,131,138
224,172,491,114,103
230,174,470,154,107
201,147,498,98,131
202,147,469,110,105
218,163,492,116,105
241,184,473,144,141
217,165,498,145,131
215,165,474,108,106
220,168,503,108,123
244,191,474,145,106
221,171,473,144,124
237,182,496,110,105
208,158,495,108,128
227,172,472,144,106
202,145,501,125,138
198,146,471,136,103
214,154,474,107,112
208,156,495,108,133
201,146,475,125,109
190,141,495,110,157
218,162,470,141,102
242,188,495,126,108
238,181,471,128,111
210,155,497,108,145
245,186,471,145,144
224,171,504,104,107
237,181,466,105,104
212,161,473,131,142
`

</script>
</body>
</html>
