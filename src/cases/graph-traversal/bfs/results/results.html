<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>chart-csv</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.css" rel="stylesheet" type="text/css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.15/d3.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
</head>
<body onload="run()">

<div id="graph"></div>

<script>

function parseCSV (csv) {
  return csv.split('\n')
    .filter(function (row) {
      return !!row.trim()
    })
    .map(function (row) {
      return row.split(',')
    })
}

function haveHead (csv) {
  return !/^\d+$/.test(csv[0][0])
}

function chart (id, csv) {
  csv = parseCSV(csv)

  var columns = []
  var showLegend = haveHead(csv)

  if (showLegend) {
    csv.shift().forEach(function (head) {
      columns.push([head])
    })
  } else {
    for (var n = 0; n < csv[0].length; n++) {
      columns.push([n])
    }
  }

  csv.forEach(function (r) {
    r.forEach(function (c, i) {
      columns[i].push(parseInt(c, 10))
    })
  })

  var opts = {
    bindto: '#' + id,
    data: {
      columns: columns,
      type: 'line'
    },
    point: { show: false },
    axis: { x: { show: false } },
    legend: { show: showLegend }
  }

  c3.generate(opts)
}

function run () {
  chart('graph', csv)
}

var csv = `
asc_liftoff,asc_turbofan,js_ignition,js_sparkplug,js_turbofan
240,168,502,106,99
245,184,472,103,102
215,161,493,142,139
202,143,472,125,134
196,141,491,126,105
218,163,472,108,124
239,181,502,144,105
214,160,471,107,123
204,150,474,106,105
212,155,486,108,129
205,150,491,133,104
211,155,471,176,137
202,148,502,115,104
208,154,470,106,104
204,143,472,147,121
221,164,496,105,104
241,183,473,109,128
223,166,489,148,105
230,178,470,101,126
203,146,492,105,104
201,146,469,104,124
220,164,504,166,103
238,186,468,114,129
219,163,467,106,105
218,164,484,134,140
224,174,490,105,104
246,186,464,105,106
228,172,506,138,138
238,180,468,132,103
210,156,470,104,106
227,173,489,112,122
202,144,469,126,105
201,147,488,108,111
213,160,470,136,128
211,154,489,101,106
202,144,474,105,145
195,143,493,122,105
220,160,473,106,105
247,187,499,122,142
239,185,474,125,101
214,160,469,104,106
244,186,482,157,139
223,171,494,100,102
240,185,469,104,109
216,161,504,106,127
200,143,467,146,104
244,185,469,148,158
246,186,491,104,101
226,177,471,105,107
238,181,487,124,111
`

</script>
</body>
</html>
