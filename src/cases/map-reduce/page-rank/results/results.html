<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>chart-csv</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.css" rel="stylesheet" type="text/css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.15/d3.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
</head>
<body onload="run()">

<div id="graph"></div>

<script>

function parseCSV (csv) {
  return csv.split('\n')
    .filter(function (row) {
      return !!row.trim()
    })
    .map(function (row) {
      return row.split(',')
    })
}

function haveHead (csv) {
  return !/^\d+$/.test(csv[0][0])
}

function chart (id, csv) {
  csv = parseCSV(csv)

  var columns = []
  var showLegend = haveHead(csv)

  if (showLegend) {
    csv.shift().forEach(function (head) {
      columns.push([head])
    })
  } else {
    for (var n = 0; n < csv[0].length; n++) {
      columns.push([n])
    }
  }

  csv.forEach(function (r) {
    r.forEach(function (c, i) {
      columns[i].push(parseInt(c, 10))
    })
  })

  var opts = {
    bindto: '#' + id,
    data: {
      columns: columns,
      type: 'line'
    },
    point: { show: false },
    axis: { x: { show: false } },
    legend: { show: showLegend }
  }

  c3.generate(opts)
}

function run () {
  chart('graph', csv)
}

var csv = `
asc_liftoff,asc_turbofan,js_ignition,js_sparkplug,js_turbofan
185,113,960,96,96
184,110,958,101,94
184,111,948,93,89
183,108,951,94,94
191,113,943,94,92
183,110,940,99,91
184,110,950,97,97
185,110,951,94,92
181,108,942,95,94
182,115,941,93,93
183,114,1001,94,91
181,108,979,95,92
181,110,957,102,94
185,113,959,92,90
180,112,996,89,92
182,109,1060,92,91
182,108,986,91,91
180,106,957,93,92
185,109,1021,96,88
182,107,940,92,92
181,107,947,91,92
181,109,948,91,91
181,107,941,93,90
182,107,938,92,95
182,107,954,95,90
181,106,948,91,89
192,112,938,90,92
180,108,953,92,92
183,108,993,91,94
183,113,935,92,138
203,112,966,97,109
202,108,994,92,90
182,110,967,91,93
211,111,986,90,99
182,111,954,93,92
181,108,997,91,98
181,108,947,95,90
187,110,937,92,92
183,112,964,90,92
183,108,1004,91,92
182,109,1006,92,92
184,115,944,92,100
184,109,1010,98,94
181,108,951,94,96
182,111,944,91,99
183,110,942,92,91
181,110,938,94,110
182,109,938,98,105
182,110,949,100,93
185,110,944,96,91
`

</script>
</body>
</html>
