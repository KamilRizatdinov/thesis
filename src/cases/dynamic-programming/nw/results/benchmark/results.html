<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>chart-csv</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.css" rel="stylesheet" type="text/css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.15/d3.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
</head>
<body onload="run()">

<div id="graph"></div>

<script>

function parseCSV (csv) {
  return csv.split('\n')
    .filter(function (row) {
      return !!row.trim()
    })
    .map(function (row) {
      return row.split(',')
    })
}

function haveHead (csv) {
  return !/^\d+$/.test(csv[0][0])
}

function chart (id, csv) {
  csv = parseCSV(csv)

  var columns = []
  var showLegend = haveHead(csv)

  if (showLegend) {
    csv.shift().forEach(function (head) {
      columns.push([head])
    })
  } else {
    for (var n = 0; n < csv[0].length; n++) {
      columns.push([n])
    }
  }

  csv.forEach(function (r) {
    r.forEach(function (c, i) {
      columns[i].push(parseInt(c, 10))
    })
  })

  var opts = {
    bindto: '#' + id,
    data: {
      columns: columns,
      type: 'line'
    },
    point: { show: false },
    axis: { x: { show: false } },
    legend: { show: showLegend }
  }

  c3.generate(opts)
}

function run () {
  chart('graph', csv)
}

var csv = `
asc_liftoff,asc_turbofan,js_ignition,js_sparkplug,js_turbofan
465,360,245,142,136
459,354,265,89,87
497,410,207,151,164
506,366,217,81,105
632,397,213,81,87
511,372,242,112,112
476,342,216,59,62
472,334,233,105,109
437,310,209,57,77
502,364,226,67,74
467,346,262,62,116
507,363,207,165,57
506,373,212,104,61
425,304,212,96,64
456,325,248,57,116
456,326,217,66,89
465,334,232,95,72
480,353,212,124,85
539,353,232,81,108
573,358,258,78,56
492,340,204,106,68
495,334,214,101,63
473,341,211,113,152
489,329,238,76,78
468,328,214,97,65
547,317,240,107,96
679,351,210,81,57
560,296,246,80,94
560,343,204,92,60
473,322,212,104,95
483,320,220,83,55
477,325,236,122,80
541,368,257,80,107
573,345,203,83,101
846,372,212,80,60
892,393,211,110,63
694,327,244,82,65
740,355,211,106,118
622,302,234,79,145
666,331,208,110,78
493,337,223,76,77
495,333,252,117,94
530,340,212,76,62
527,347,212,75,102
586,344,243,92,60
621,374,207,103,67
537,367,220,78,88
490,365,243,105,101
509,315,207,76,74
515,340,242,104,82
`

</script>
</body>
</html>
