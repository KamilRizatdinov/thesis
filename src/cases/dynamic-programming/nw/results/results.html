<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>chart-csv</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.css" rel="stylesheet" type="text/css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.15/d3.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
</head>
<body onload="run()">

<div id="graph"></div>

<script>

function parseCSV (csv) {
  return csv.split('\n')
    .filter(function (row) {
      return !!row.trim()
    })
    .map(function (row) {
      return row.split(',')
    })
}

function haveHead (csv) {
  return !/^\d+$/.test(csv[0][0])
}

function chart (id, csv) {
  csv = parseCSV(csv)

  var columns = []
  var showLegend = haveHead(csv)

  if (showLegend) {
    csv.shift().forEach(function (head) {
      columns.push([head])
    })
  } else {
    for (var n = 0; n < csv[0].length; n++) {
      columns.push([n])
    }
  }

  csv.forEach(function (r) {
    r.forEach(function (c, i) {
      columns[i].push(parseInt(c, 10))
    })
  })

  var opts = {
    bindto: '#' + id,
    data: {
      columns: columns,
      type: 'line'
    },
    point: { show: false },
    axis: { x: { show: false } },
    legend: { show: showLegend }
  }

  c3.generate(opts)
}

function run () {
  chart('graph', csv)
}

var csv = `
asc_liftoff,asc_turbofan,js_ignition,js_sparkplug,js_turbofan
512,361,240,90,108
478,338,208,60,60
473,326,240,98,104
448,304,207,55,55
509,362,243,65,64
484,332,205,85,64
505,352,208,100,139
520,370,218,58,76
446,302,232,66,91
461,316,259,63,58
462,323,201,149,107
475,328,211,76,56
498,350,209,62,63
481,335,237,93,63
508,351,210,60,146
476,334,230,91,76
473,332,207,61,63
479,333,224,103,82
470,330,249,55,60
468,324,205,62,153
439,310,211,112,79
492,344,210,55,92
421,292,236,61,58
479,335,208,62,107
453,311,235,99,55
461,320,203,121,59
459,322,245,85,67
502,356,203,79,117
484,338,206,92,156
525,376,218,101,78
539,388,230,80,105
467,321,253,123,117
495,354,202,74,67
438,292,209,83,62
463,325,256,86,95
474,327,208,110,57
470,325,213,84,107
482,337,208,111,54
478,335,251,76,59
494,339,210,108,64
525,365,207,77,108
500,362,228,115,149
501,388,211,75,77
456,312,217,76,91
464,327,232,90,58
454,319,257,104,109
477,334,205,80,55
441,310,211,122,63
480,334,209,74,65
455,314,241,77,147
`

</script>
</body>
</html>
